image: maven:latest
cache:
  key: "$CI_JOB_STAGE-$CI_COMMIT_REF_SLUG"
  paths:
    - target/

stages:
    - build
    - test
    - package
    
build:
  stage: build
  script:
    - mvn compile

test:
  stage: test
  script:
    - mvn test

package:
  stage: package
  script:
    - mvn package
  artifacts:
    paths: 
      - target/injectenvbeforescm.hpi
  only:
    - master